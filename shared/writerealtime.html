<head>
  <title>WriteRealtime - Meteorjs contenteditable demo</title>
</head>

<body>
</body>

<template name="layout">
	<div class="container">
		<header>
			{{> nav}}
		</header>
		{{> yield}}
	</div>
</template>

<template name="nav">
	<button class="btn btn-primary edit-article">{{#if editing}}Finished{{else}}Edit{{/if}}</button>
	<button class="btn btn-primary add-new-article">Add New Article</button>
	<a class="btn btn-default github-link" href="https://github.com/bobbigmac/write-realtime">View on github</a>
</template>

<template name="fragmenttagprivate">
	<p contenteditable="{{editable}}" data-id="{{this._id}}" class="fragment-text">{{this.text}}</p>
</template>

<template name="fragmenttaghr">
	{{#if editing}}
		<hr data-id="{{this._id}}" class="fragment-text" />
	{{else}}
		<hr data-id="{{this._id}}" class="fragment-text" />
	{{/if}}
</template>

<template name="fragmenttagtable">
	<table contenteditable="{{editable}}" data-id="{{this._id}}" class="fragment-text">{{this.text}}</table>
</template>

<template name="fragmenttagquote">
	<q contenteditable="{{editable}}" data-id="{{this._id}}" class="fragment-text">{{this.text}}</q>
</template>

<template name="fragmenttagblockquote">
	<blockquote contenteditable="{{editable}}" data-id="{{this._id}}" class="fragment-text">{{this.text}}</blockquote>
</template>

<template name="fragmenttagspan">
	<span contenteditable="{{editable}}" data-id="{{this._id}}" class="fragment-text">{{this.text}}</span>
</template>

<template name="fragmenttagp">
	<p contenteditable="{{editable}}" data-id="{{this._id}}" class="fragment-text">{{this.text}}</p>
</template>

<template name="fragmenttagh1">
	<h1 contenteditable="{{editable}}" data-id="{{this._id}}" class="fragment-text">{{this.text}}</h1>
</template>

<template name="fragmenttagh2">
	<h2 contenteditable="{{editable}}" data-id="{{this._id}}" class="fragment-text">{{this.text}}</h2>
</template>

<template name="fragmenttagh3">
	<h3 contenteditable="{{editable}}" data-id="{{this._id}}" class="fragment-text">{{this.text}}</h3>
</template>

<template name="fragmenttagh4">
	<h4 contenteditable="{{editable}}" data-id="{{this._id}}" class="fragment-text">{{this.text}}</h4>
</template>

<template name="fragmentproxy">
	{{#if equals tag "p"}}
		{{>fragmenttagp}}
	{{else}}
		{{#if equals tag "h1"}}
			{{>fragmenttagh1}}
		{{else}}
			{{#if equals tag "h2"}}
				{{>fragmenttagh2}}
			{{else}}
				{{#if equals tag "h3"}}
					{{>fragmenttagh3}}
				{{else}}
					{{#if equals tag "h4"}}
						{{>fragmenttagh4}}
					{{else}}
						{{#if equals tag "span"}}
							{{>fragmenttagspan}}
						{{else}}
							{{#if equals tag "nb"}}
								{{>fragmenttagprivate}}
							{{else}}
								{{#if equals tag "bq"}}
									{{>fragmenttagblockquote}}
								{{else}}
									{{#if equals tag "q"}}
										{{>fragmenttagquote}}
									{{else}}
										{{#if equals tag "table"}}
											{{>fragmenttagtable}}
										{{else}}
											{{#if equals tag "hr"}}
												{{>fragmenttaghr}}
											{{else}}
												{{>fragmenttagp}}
											{{/if}}
										{{/if}}
									{{/if}}
								{{/if}}
							{{/if}}
						{{/if}}
					{{/if}}
				{{/if}}
			{{/if}}
		{{/if}}
	{{/if}}
</template>

<template name="fragment">
	<div class="fragment-container" data-id="{{this._id}}" data-tag="{{tag}}" editable="{{editable}}">
		<div class="handle"><i class="glyphicon glyphicon-th-list"> </i>
		</div>
		<div class="options">
			<select class="form-control select-transparent fragment-set-tag" tabindex="-1" data-width="40">
			  <option {{selected tag "p"}}>p</option>
			  <option {{selected tag "q"}}>q</option>
			  <option {{selected tag "h1"}}>h1</option>
			  <option {{selected tag "h2"}}>h2</option>
			  <option {{selected tag "h3"}}>h3</option>
			  <option {{selected tag "h4"}}>h4</option>
			  <option {{selected tag "bq"}}>bq</option>
			  <option {{selected tag "nb"}}>nb</option>
			</select>
		</div>
		{{>fragmentproxy}}
	</div>
</template>

<template name="articles">
	{{#each articles}}
		{{>articleLink}}
	{{/each}}
</template>

<template name="articleLink">
	<p><a href="{{linkUrl}}">{{linkText}}</a></p>
</template>

<template name="article">
	<div class="fragments" data-id="{{this._id}}">
		{{#each fragments}}
			{{>fragment}}
		{{/each}}
	</div>
</template>
